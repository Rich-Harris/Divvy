(function(t){"use strict";var e=function(){var t,i,s,n,o,h,r,d,c,a,l,u,v,m,p;return h="row",r="column",d="left",c="top",a="width",l="height",u="vertical",v="horizontal",m="clientX",p="clientY",s=function(t,e){var i,s;for(i=0,s=e.length;s>i;i+=1)if(e[i]===t)return t;return-1},n=function(t,e){var i;t.classList&&t.classList.add?n=function(t,e){t.classList.add(e)}:(i=function(t){return t.replace(/^\s*/,"").replace(/\s*$/)},n=function(t,e){var n,o;n=t.className.split(" ").map(i),o=n.indexOf?n.indexOf(e):s(e,n),-1===o&&(t.className=n.concat(e).join(" "))}),n(t,e)},o=function(t,e){var i;t.classList&&t.classList.remove?o=function(t,e){t.classList.remove(e)}:(i=function(t){return t.replace(/^\s*/,"").replace(/\s*$/)},o=function(t,e){var n,o;n=t.className.split(" ").map(i),o=n.indexOf?n.indexOf(e):s(e,n),-1!==o&&(n.splice(o,1),t.className=n.join(" "))}),o(t,e)},t=function(e,s,o,m,p,f,y,g,w){var x,b,z,E,P,k,L,S,C;if(this.start=f,this.size=y,this.end=this.start+this.size,this.type=g,this.parent=s,this.edges=w,this.min=p.min||e.min,this.max=p.max,p instanceof Element&&(p={node:p}),"string"==typeof p&&(p={id:p}),"[object Array]"===Object.prototype.toString.call(p)&&(p={children:p}),this.id=p.id||m,p.children&&p.children.length?(this.node=document.createElement("div"),n(this.node,"divvy-block"),n(this.node,"divvy-branch")):(this.node=document.createElement("div"),n(this.node,"divvy-block"),n(this.node,"divvy-leaf"),!p.node&&p.id&&(k=document.getElementById(p.id))&&(p.node=k),this.inner=p.node?p.node:document.createElement("div"),n(this.inner,"divvy-inner"),this.node.appendChild(this.inner),e.blocks[this.id]=this.inner),w.top&&n(this.node,"divvy-top"),w.right&&n(this.node,"divvy-right"),w.bottom&&n(this.node,"divvy-bottom"),w.left&&n(this.node,"divvy-left"),this.node.style[g===r?d:c]=f+"%",this.node.style[g===r?a:l]=y+"%",this.node.id=this.id,p.children){for(x=p.children.reduce(function(t,e){return t+(e.size||1)},0),this.children=[],this.controls=[],z=0,b=0;p.children.length>b;b+=1)E=p.children[b],P=100*((E.size||1)/x),C={},g===r?(C.top=w.top&&0===b,C.bottom=w.bottom&&b===p.children.length-1,C.left=w.left,C.right=w.right):(C.left=w.left&&0===b,C.right=w.right&&b===p.children.length-1,C.top=w.top,C.bottom=w.bottom),this.children[b]=new t(e,this,this.node,m+b,E,z,P,g===r?h:r,C),z+=P;for(b=0;p.children.length-1>b;b+=1)L=this.children[b],S=this.children[b+1],this.controls[b]=new i(e,this,this.node,L,S,g===h?u:v)}o.appendChild(this.node)},t.prototype={setStart:function(t){var e,i,s,n;e=this.start,i=this.size,s=t-e,n=i-s,this.node.style[this.type===r?d:c]=t+"%",this.node.style[this.type===r?a:l]=n+"%",this.start=t,this.size=n,this.shake()},setEnd:function(t){var e,i,s,n;e=this.end,i=this.size,s=t-e,n=i+s,this.node.style[this.type===r?a:l]=n+"%",this.end=t,this.size=n,this.shake()},shake:function(){var t,e,i,s,n,o;if(this.children){for(this.bcr=this.node.getBoundingClientRect(),this.pixelSize=this.bcr[this.type===r?l:a],e=this.children.length,t=0;e-1>t;t+=1)i=this.children[t],s=this.children[t+1],n=this.controls[t],o=i.minPc(),o>i.size&&(i.setEnd(i.start+o),s.setStart(i.start+o),n.setPosition(i.start+o)),o=i.maxPc(),i.size>o&&(i.setEnd(i.start+o),s.setStart(i.start+o),n.setPosition(i.start+o));for(t=e-1;t>0;t-=1)i=this.children[t-1],s=this.children[t],n=this.controls[t-1],o=s.minPc(),o>s.size&&(i.setEnd(s.end-o),s.setStart(s.end-o),n.setPosition(s.end-o)),o=s.maxPc(),s.size>o&&(i.setEnd(s.end-o),s.setStart(s.end-o),n.setPosition(s.end-o));for(t=this.children.length;t--;)this.children[t].shake()}},minPc:function(){var t;return t=this.parent.pixelSize,100*(this.min/t)},maxPc:function(){var t;return this.max?(t=this.parent.pixelSize,100*(this.max/t)):100}},i=function(t,e,i,s,o,h){var r=this;this.root=t,this.parent=e,this.before=s,this.after=o,this.type=h,this.parentNode=i,this.node=document.createElement("div"),n(this.node,"divvy-"+h+"-control"),this.setPosition(o.start),this.node.addEventListener("mousedown",function(t){var e,i,n,d,c;r.setActive(),t.preventDefault(),e=Math.max(s.start+s.minPc(),o.end-o.maxPc()),i=Math.min(s.start+s.maxPc(),o.end-o.minPc()),n=function(t){var n;n=r.getPosition(t[h===u?m:p]),n=Math.max(e,Math.min(i,n)),s.setEnd(n),o.setStart(n),r.setPosition(n)},d=function(){r.setInactive(),c()},c=function(){window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",d)},window.addEventListener("mousemove",n),window.addEventListener("mouseup",d)}),i.appendChild(this.node)},i.prototype={setActive:function(){n(this.node,"divvy-active"),this.root.cursor(this.type===u?"ew":"ns")},setInactive:function(){o(this.node,"divvy-active"),this.root.cursor(!1)},getPosition:function(t){var e,i,s,n;return e=this.parent.bcr,i=e[this.type===u?d:c],s=e[this.type===u?a:l],n=100*(t-i)/s},setPosition:function(t){this.node.style[this.type===u?d:c]=t+"%"}},e=function(e){var i,s,n=this;if(this.el=e.el,i=document.createDocumentFragment(),e.columns&&e.rows)throw Error("You can't have top level rows and top level columns - one or the other");e.columns?(this.type=h,s=e.columns):e.rows&&(this.type=r,s=e.rows),this.blocks={},this.min=e.min||10,this.root=new t(this,this,i,"divvy-0",{children:s},0,100,this.type,{top:!0,right:!0,bottom:!0,left:!0}),this.el.appendChild(i),e.shakeOnResize!==!1&&window.addEventListener("resize",function(){n.shake()}),this.shake()},e.prototype={shake:function(){this.bcr=this.el.getBoundingClientRect(),this.pixelSize=this.bcr[this.type===r?l:a],this.root.shake()},cursor:function(t){return t?(this._cursor=this.el.style.cursor,this.el.style.cursor=t+"-resize",void 0):(this.el.style.cursor=this._cursor,void 0)}},e}();t.module!==void 0&&t.module.exports?t.module.exports=e:t.define!==void 0&&t.define.amd?t.define(function(){return e}):t.Divvy=e})(this);