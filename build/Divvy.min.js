(function(t){"use strict";var e=function(){var t,i,n,s,o,r,h,d,c,a,l,u,v,m,p;return r="row",h="column",d="left",c="top",a="width",l="height",u="vertical",v="horizontal",m="clientX",p="clientY",n=function(t,e){var i,n;for(i=0,n=e.length;n>i;i+=1)if(e[i]===t)return t;return-1},s=function(t,e){var i;t.classList&&t.classList.add?s=function(t,e){t.classList.add(e)}:(i=function(t){return t.replace(/^\s*/,"").replace(/\s*$/)},s=function(t,e){var s,o;s=t.className.split(" ").map(i),o=s.indexOf?s.indexOf(e):n(e,s),-1===o&&(t.className=s.concat(e).join(" "))}),s(t,e)},o=function(t,e){var i;t.classList&&t.classList.remove?o=function(t,e){t.classList.remove(e)}:(i=function(t){return t.replace(/^\s*/,"").replace(/\s*$/)},o=function(t,e){var s,o;s=t.className.split(" ").map(i),o=s.indexOf?s.indexOf(e):n(e,s),-1!==o&&(s.splice(o,1),t.className=s.join(" "))}),o(t,e)},t=function(e,n,o,m,p,f,y,g,w){var x,b,z,E,P,L,k,S,C;if(this.start=f,this.size=y,this.end=this.start+this.size,this.type=g,this.parent=n,this.edges=w,this.min=p.min||e.min,this.max=p.max,p instanceof Element&&(p={node:p}),"string"==typeof p&&(p={id:p}),"[object Array]"===Object.prototype.toString.call(p)&&(p={children:p}),this.id=p.id||m,p.children&&p.children.length?(this.node=document.createElement("div"),s(this.node,"divvy-block"),s(this.node,"divvy-branch")):(this.node=document.createElement("div"),s(this.node,"divvy-block"),s(this.node,"divvy-leaf"),!p.node&&p.id&&(L=document.getElementById(p.id))&&(p.node=L),this.inner=p.node?p.node:document.createElement("div"),s(this.inner,"divvy-inner"),this.node.appendChild(this.inner),e.blocks[this.id]=this.inner),w.top&&s(this.node,"divvy-top"),w.right&&s(this.node,"divvy-right"),w.bottom&&s(this.node,"divvy-bottom"),w.left&&s(this.node,"divvy-left"),this.node.style[g===h?d:c]=f+"%",this.node.style[g===h?a:l]=y+"%",this.node.id=this.id,p.children){for(x=p.children.reduce(function(t,e){return t+(e.size||1)},0),this.children=[],this.controls=[],z=0,b=0;p.children.length>b;b+=1)E=p.children[b],P=100*((E.size||1)/x),C={},g===h?(C.top=w.top&&0===b,C.bottom=w.bottom&&b===p.children.length-1,C.left=w.left,C.right=w.right):(C.left=w.left&&0===b,C.right=w.right&&b===p.children.length-1,C.top=w.top,C.bottom=w.bottom),this.children[b]=new t(e,this,this.node,m+b,E,z,P,g===h?r:h,C),z+=P;for(b=0;p.children.length-1>b;b+=1)k=this.children[b],S=this.children[b+1],this.controls[b]=new i(e,this,this.node,k,S,g===r?u:v)}o.appendChild(this.node)},t.prototype={setStart:function(t){var e,i,n,s;e=this.start,i=this.size,n=t-e,s=i-n,this.node.style[this.type===h?d:c]=t+"%",this.node.style[this.type===h?a:l]=s+"%",this.start=t,this.size=s},setEnd:function(t){var e,i,n,s;e=this.end,i=this.size,n=t-e,s=i+n,this.node.style[this.type===h?a:l]=s+"%",this.end=t,this.size=s},shake:function(){var t,e,i,n,s,o;if(this.children){for(this.bcr=this.node.getBoundingClientRect(),this.pixelSize=this.bcr[this.type===h?l:a],e=this.children.length,t=0;e-1>t;t+=1)i=this.children[t],n=this.children[t+1],s=this.controls[t],o=i.minPc(),o>i.size&&(i.setEnd(i.start+o),n.setStart(i.start+o),s.setPosition(i.start+o)),o=i.maxPc(),i.size>o&&(i.setEnd(i.start+o),n.setStart(i.start+o),s.setPosition(i.start+o));for(t=e-1;t>0;t-=1)i=this.children[t-1],n=this.children[t],s=this.controls[t-1],o=n.minPc(),o>n.size&&(i.setEnd(n.end-o),n.setStart(n.end-o),s.setPosition(n.end-o)),o=n.maxPc(),n.size>o&&(i.setEnd(n.end-o),n.setStart(n.end-o),s.setPosition(n.end-o));for(t=this.children.length;t--;)this.children[t].shake()}},minPc:function(){var t;return t=this.parent.pixelSize,100*(this.min/t)},maxPc:function(){var t;return this.max?(t=this.parent.pixelSize,100*(this.max/t)):100}},i=function(t,e,i,n,o,r){var h=this;this.root=t,this.parent=e,this.before=n,this.after=o,this.type=r,this.parentNode=i,this.node=document.createElement("div"),s(this.node,"divvy-"+r+"-control"),this.setPosition(o.start),this.node.addEventListener("mousedown",function(t){var e,i,s,d,c;h.setActive(),t.preventDefault(),e=Math.max(n.start+n.minPc(),o.end-o.maxPc()),i=Math.min(n.start+n.maxPc(),o.end-o.minPc()),s=function(t){var s;s=h.getPosition(t[r===u?m:p]),s=Math.max(e,Math.min(i,s)),n.setEnd(s),o.setStart(s),h.setPosition(s)},d=function(){h.setInactive(),c()},c=function(){window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",d)},window.addEventListener("mousemove",s),window.addEventListener("mouseup",d)}),i.appendChild(this.node)},i.prototype={setActive:function(){s(this.node,"divvy-active"),this.root.cursor(this.type===u?"ew":"ns")},setInactive:function(){o(this.node,"divvy-active"),this.root.cursor(!1)},getPosition:function(t){var e,i,n,s;return e=this.parent.bcr,i=e[this.type===u?d:c],n=e[this.type===u?a:l],s=100*(t-i)/n},setPosition:function(t){this.node.style[this.type===u?d:c]=t+"%"}},e=function(e){var i,n,s=this;if(this.el=e.el,i=document.createDocumentFragment(),e.columns&&e.rows)throw Error("You can't have top level rows and top level columns - one or the other");e.columns?(this.type=r,n=e.columns):e.rows&&(this.type=h,n=e.rows),this.blocks={},this.min=e.min||10,this.root=new t(this,this,i,"divvy-0",{children:n},0,100,this.type,{top:!0,right:!0,bottom:!0,left:!0}),this.el.appendChild(i),e.shakeOnResize!==!1&&window.addEventListener("resize",function(){s.shake()}),this.shake()},e.prototype={shake:function(){this.bcr=this.el.getBoundingClientRect(),this.pixelSize=this.bcr[this.type===h?l:a],this.root.shake()},cursor:function(t){return t?(this._cursor=this.el.style.cursor,this.el.style.cursor=t+"-resize",void 0):(this.el.style.cursor=this._cursor,void 0)}},e}();t.module!==void 0&&t.module.exports?t.module.exports=e:t.define!==void 0&&t.define.amd?t.define(function(){return e}):t.Divvy=e})(this);